<!doctype html>
<html lang="en-US" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-move/move-test/move-unit-test">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.22">
<title data-rh="true">Unit Tests | Starcoin Cookbook</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://starcoinorg.github.io/docs/move/move-test/move-unit-test"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Unit Tests | Starcoin Cookbook"><meta data-rh="true" name="description" content="Unit testing for Move adds three new annotations to the Move source language:"><meta data-rh="true" property="og:description" content="Unit testing for Move adds three new annotations to the Move source language:"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://starcoinorg.github.io/docs/move/move-test/move-unit-test"><link data-rh="true" rel="alternate" href="https://starcoinorg.github.io/docs/move/move-test/move-unit-test" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://starcoinorg.github.io/zh/docs/move/move-test/move-unit-test" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://starcoinorg.github.io/docs/move/move-test/move-unit-test" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.bd80adfe.css">
<link rel="preload" href="/assets/js/runtime~main.b2f11fa7.js" as="script">
<link rel="preload" href="/assets/js/main.cc2f6e2d.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Starcoin Cookbook" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="Starcoin Cookbook" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Starcoin Cookbook</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Documents</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/move/move-test/move-unit-test" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li><li><a href="/zh/docs/move/move-test/move-unit-test" target="_self" rel="noopener noreferrer" class="dropdown__link">中文</a></li></ul></div><a href="https://github.com/starcoinorg/starcoin-cookbook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Starcoin CookBook Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/getting-started/install/">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/move/">Move and SmartContract Development</a><button aria-label="Toggle the collapsible sidebar category &#x27;Move and SmartContract Development&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/move/prepare-move-env">Setting up Move develop environment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/move/quick-start">Quick Start</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/move/move-language/">Move Language</a><button aria-label="Toggle the collapsible sidebar category &#x27;Move Language&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/move/understanding-ability">Understanding abilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/move/move-package-manager">User Guide of Move Package Manager</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/move/starcoin-framework/">Starcoin Move Framework</a><button aria-label="Toggle the collapsible sidebar category &#x27;Starcoin Move Framework&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/move/deploy-first-move-contract">How to deploy Move smart contracts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/move/interacting-with-the-contract">Interacting with the contract by CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/move/module-dependency">Understanding module dependency</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/move/how-to-upgrade">How to upgrade Move Module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/move/for-solidity-developer">For solidity developer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/move/call-function">How to call a function</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/move/move-vm/">README</a><button aria-label="Toggle the collapsible sidebar category &#x27;README&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/move/move-test/">How to test Move Module</a><button aria-label="Toggle the collapsible sidebar category &#x27;How to test Move Module&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/move/move-test/move-unit-test">Unit Tests</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/move/move-test/move-integration-test">Write Move integration test</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/move/move-test/how-to-debug">How to debug Move module and troubleshooting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/move/move-test/disassembler">Move VM, Bytecode, and Disassembler</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/move/move-examples/">More Move Examples</a><button aria-label="Toggle the collapsible sidebar category &#x27;More Move Examples&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/move/advance-move/">Advance Move Development</a><button aria-label="Toggle the collapsible sidebar category &#x27;Advance Move Development&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/move/move-prover/">Move Specification Language and Move Prover</a><button aria-label="Toggle the collapsible sidebar category &#x27;Move Specification Language and Move Prover&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/web3/">Web3 and DApp Development</a><button aria-label="Toggle the collapsible sidebar category &#x27;Web3 and DApp Development&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/reference/">Reference</a><button aria-label="Toggle the collapsible sidebar category &#x27;Reference&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/concepts/">Concepts</a><button aria-label="Toggle the collapsible sidebar category &#x27;Concepts&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/miscellaneous/contributing">Miscellaneous</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/move/"><span itemprop="name">Move and SmartContract Development</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/move/move-test/"><span itemprop="name">How to test Move Module</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Unit Tests</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Unit Tests</h1><p>Unit testing for Move adds three new annotations to the Move source language:</p><ul><li><code>#[test]</code></li><li><code>#[test_only]</code></li><li><code>#[expected_failure]</code></li></ul><p>They respectively mark a function as a test, mark a module or module member (<code>use</code>, <code>fun</code>, or <code>struct</code>) as code to be included for testing only, and mark that a test is expected to fail. These annotations can be placed on a function with any visibility. Whenever a module or module member is annotated as <code>#[test_only]</code> or <code>#[test]</code>, it will not be included in the compiled bytecode unless it is compiled for testing.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="testing-annotations-their-meaning-and-usage">Testing Annotations: Their Meaning and Usage<a class="hash-link" href="#testing-annotations-their-meaning-and-usage" title="Direct link to heading">​</a></h2><p>Both the <code>#[test]</code> and <code>#[expected_failure]</code> annotations can be used either with or without arguments.</p><p>Without arguments, the <code>#[test]</code> annotation can only be placed on a function with no parameters. This annotation simply marks this function as a test to be run by the unit testing harness.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#[test] // OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun this_is_a_test() { ... }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[test] // Will fail to compile since the test takes an argument</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun this_is_not_correct(arg: signer) { ... }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>A test can also be annotated as an <code>#[expected_failure]</code>. This annotation marks that the test should is expected to raise an error. You can ensure that a test is aborting with a specific abort code by annotating it with <code>#[expected_failure(abort_code = &lt;code&gt;)]</code>, if it then fails with a different abort code or with a non-abort error the test will fail. Only functions that have the <code>#[test]</code> annotation can also be annotated as an <code>#[expected_failure]</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#[test]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[expected_failure]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public fun this_test_will_abort_and_pass() { abort 1 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[test]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[expected_failure]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public fun test_will_error_and_pass() { 1/0; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[test]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[expected_failure(abort_code = 0)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public fun test_will_error_and_fail() { 1/0; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[test, expected_failure] // Can have multiple in one attribute. This test will pass.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public(script) fun this_other_test_will_abort_and_pass() { abort 1 }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>With arguments, a test annotation takes the form <code>#[test(&lt;param_name_1&gt; = &lt;address&gt;, ..., &lt;param_name_n&gt; = &lt;address&gt;)]</code>. If a function is annotated in such a manner, the function&#x27;s parameters must be a permutation of the parameters <code>&lt;param_name_1&gt;, ..., &lt;param_name_n&gt;</code>, i.e., the order of these parameters as they occur in the function and their order in the test annotation do not have to be the same, but they must be able to be matched up with each other by name.</p><p>Only parameters with a type of <code>signer</code> are supported as test parameters. If a <code>non-signer</code> parameter is supplied, the test will result in an error when run.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#[test(arg = @0xC0FFEE)] // OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun this_is_correct_now(arg: signer) { ... }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[test(wrong_arg_name = @0xC0FFEE)] // Not correct: arg name doesn&#x27;t match</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun this_is_incorrect(arg: signer) { ... }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[test(a = @0xC0FFEE, b = @0xCAFE)] // OK. We support multiple signer arguments, but you must always provide a value for that argument</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun this_works(a: signer, b: signer) { ... }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// somewhere a named address is declared</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[test_only] // test-only named addresses are supported</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">address TEST_NAMED_ADDR = @0x1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[test(arg = @TEST_NAMED_ADDR)] // Named addresses are supported!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun this_is_correct_now(arg: signer) { ... }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>An expected failure annotation can also take the form <code>#[expected_failure(abort_code = &lt;u64&gt;)]</code>. If a test function is annotated in such a way, the test must abort with an abort code equal to <code>&lt;u64&gt;</code>. Any other failure or abort code will result in a test failure.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#[test, expected_failure(abort_code = 1)] // This test will fail</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun this_test_should_abort_and_fail() { abort 0 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[test]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[expected_failure(abort_code = 0)] // This test will pass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun this_test_should_abort_and_pass_too() { abort 0 }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>A module and any of its members can be declared as test only. In such a case the item will only be included in the compiled Move bytecode when compiled in test mode. Additionally, when compiled outside of test mode, any non-test <code>use</code> s of a <code>#[test_only]</code> module will raise an error during compilation.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#[test_only] // test only attributes can be attached to modules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module ABC { ... }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[test_only] // test only attributes can be attached to named addresses</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">address ADDR = @0x1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[test_only] // .. to uses</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use 0x1::SomeOtherModule;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[test_only] // .. to structs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">struct SomeStruct { ... }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[test_only] // .. and functions. Can only be called from test code, but not a test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun test_only_function(...) { ... }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="running-unit-tests">Running Unit Tests<a class="hash-link" href="#running-unit-tests" title="Direct link to heading">​</a></h2><p>Unit tests for a Move package can be run with the <code>move package test</code> command.</p><p>When running tests, every test will either <code>PASS</code>, <code>FAIL</code>, or <code>TIMEOUT</code>. If a test case fails, the location of the failure along with the function name that caused the failure will be reported if possible. You can see an example of this below.</p><p>A test will be marked as timing out if it exceeds the maximum number of instructions that can be executed for any single test. This bound can be changed using the options below, and its default value is set to 5000 instructions. Additionally, while the result of a test is always deterministic, tests are run in parallel by default, so the ordering of test results in a test run is non-deterministic unless running with only one thread (see <code>OPTIONS</code> below).</p><p>There are also a number of options that can be passed to the unit testing binary to fine-tune testing and to help debug failing tests. These can be found using the the help flag:
<code>mpm pacakge -h</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="example">Example<a class="hash-link" href="#example" title="Direct link to heading">​</a></h2><p>A simple module using some of the unit testing features is shown in the following example:</p><p>First create an empty package and change directory into it:</p><p><code>$ move package new TestExample; cd TestExample</code></p><p>Next add the following to the <code>Move.toml</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// filename: sources/MyModule.move</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module 0x1::MyModule {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    struct MyCoin has key { value: u64 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public fun make_sure_non_zero_coin(coin: MyCoin): MyCoin {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assert!(coin.value &gt; 0, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        coin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public fun has_coin(addr: address): bool {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        exists&lt;MyCoin&gt;(addr)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[test]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun make_sure_non_zero_coin_passes() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let coin = MyCoin { value: 1 };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let MyCoin { value: _ } = make_sure_non_zero_coin(coin);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[test]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Or #[expected_failure] if we don&#x27;t care about the abort code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[expected_failure(abort_code = 0)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun make_sure_zero_coin_fails() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let coin = MyCoin { value: 0 };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let MyCoin { value: _ } = make_sure_non_zero_coin(coin);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[test_only] // test only helper function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun publish_coin(account: &amp;signer) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        move_to(account, MyCoin { value: 1 })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[test(a = @0x1, b = @0x2)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun test_has_coin(a: signer, b: signer) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        publish_coin(&amp;a);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        publish_coin(&amp;b);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assert!(has_coin(@0x1), 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assert!(has_coin(@0x2), 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assert!(!has_coin(@0x3), 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next add the following module under the <code>sources</code> directory:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// filename: sources/MyModule.move</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module 0x1::MyModule {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    struct MyCoin has key { value: u64 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public fun make_sure_non_zero_coin(coin: MyCoin): MyCoin {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assert!(coin.value &gt; 0, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        coin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public fun has_coin(addr: address): bool {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        exists&lt;MyCoin&gt;(addr)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[test]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun make_sure_non_zero_coin_passes() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let coin = MyCoin { value: 1 };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let MyCoin { value: _ } = make_sure_non_zero_coin(coin);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[test]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Or #[expected_failure] if we don&#x27;t care about the abort code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[expected_failure(abort_code = 0)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun make_sure_zero_coin_fails() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let coin = MyCoin { value: 0 };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let MyCoin { value: _ } = make_sure_non_zero_coin(coin);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[test_only] // test only helper function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun publish_coin(account: &amp;signer) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        move_to(account, MyCoin { value: 1 })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[test(a = @0x1, b = @0x2)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun test_has_coin(a: signer, b: signer) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        publish_coin(&amp;a);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        publish_coin(&amp;b);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assert!(has_coin(@0x1), 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assert!(has_coin(@0x2), 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assert!(!has_coin(@0x3), 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="running-tests">Running Tests<a class="hash-link" href="#running-tests" title="Direct link to heading">​</a></h2><p>You can then run these tests with the <code>mpm package test</code> command:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ mpm package test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BUILDING MoveStdlib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BUILDING TestExample</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Running Move unit tests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ PASS    ] 0x1::MyModule::make_sure_non_zero_coin_passes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ PASS    ] 0x1::MyModule::make_sure_zero_coin_fails</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ PASS    ] 0x1::MyModule::test_has_coin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test result: OK. Total tests: 3; passed: 3; failed: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-test-flags">Using Test Flags<a class="hash-link" href="#using-test-flags" title="Direct link to heading">​</a></h2><p>Type <code>&lt;str&gt;</code> following <code>mpm package test</code>, which will only run tests whose fully qualified name contains <code>&lt;str&gt;</code>. For example, if we want to only run tests with <code>&quot;zero_coin&quot;</code> in their name:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ mpm package test zero_coin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CACHED MoveStdlib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BUILDING TestExample</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Running Move unit tests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ PASS    ] 0x1::MyModule::make_sure_non_zero_coin_passes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ PASS    ] 0x1::MyModule::make_sure_zero_coin_fails</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test result: OK. Total tests: 2; passed: 2; failed: 0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>-i &lt;bound&gt;</code> or <code>--instructions &lt;bound&gt;</code></p><p>This bounds the number of instructions that can be executed for any one test to <code>&lt;bound&gt;</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ mpm package test -i 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CACHED MoveStdlib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BUILDING TestExample</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Running Move unit tests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ TIMEOUT ] 0x1::MyModule::make_sure_non_zero_coin_passes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ TIMEOUT ] 0x1::MyModule::make_sure_zero_coin_fails</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ TIMEOUT ] 0x1::MyModule::test_has_coin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test failures:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Failures in 0x1::MyModule:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">┌── make_sure_non_zero_coin_passes ──────</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ Test timed out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└──────────────────</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">┌── make_sure_zero_coin_fails ──────</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ Test timed out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└──────────────────</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">┌── test_has_coin ──────</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ Test timed out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└──────────────────</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test result: FAILED. Total tests: 3; passed: 0; failed: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>-s</code> or <code>--statistics</code>
With these flags you can gather statistics about the tests run and report the runtime and instructions executed for each test. For example, if we wanted to see the statistics for the tests in the example above:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ mpm package test -s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CACHED MoveStdlib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BUILDING TestExample</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Running Move unit tests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ PASS    ] 0x1::MyModule::make_sure_non_zero_coin_passes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ PASS    ] 0x1::MyModule::make_sure_zero_coin_fails</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ PASS    ] 0x1::MyModule::test_has_coin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test Statistics:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">┌───────────────────────────────────────────────┬────────────┬───────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                   Test Name                   │    Time    │   Instructions Executed   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├───────────────────────────────────────────────┼────────────┼───────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 0x1::MyModule::make_sure_non_zero_coin_passes │   0.009    │             1             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├───────────────────────────────────────────────┼────────────┼───────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 0x1::MyModule::make_sure_zero_coin_fails      │   0.008    │             1             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├───────────────────────────────────────────────┼────────────┼───────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 0x1::MyModule::test_has_coin                  │   0.008    │             1             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└───────────────────────────────────────────────┴────────────┴───────────────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test result: OK. Total tests: 3; passed: 3; failed: 0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>-g</code> or <code>--state-on-error</code>
These flags will print the global state for any test failures. e.g., if we added the following (failing) test to the <code>MyModule</code> example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">module 0x1::MyModule {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[test(a = @0x1)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun test_has_coin_bad(a: signer) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        publish_coin(&amp;a);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assert!(has_coin(@0x1), 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assert!(has_coin(@0x2), 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>we would get get the following output when running the tests:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ mpm package test -g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CACHED MoveStdlib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BUILDING TestExample</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Running Move unit tests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ PASS    ] 0x1::MyModule::make_sure_non_zero_coin_passes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ PASS    ] 0x1::MyModule::make_sure_zero_coin_fails</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ PASS    ] 0x1::MyModule::test_has_coin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ FAIL    ] 0x1::MyModule::test_has_coin_bad</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test failures:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Failures in 0x1::MyModule:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">┌── test_has_coin_bad ──────</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ error[E11001]: test failure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    ┌─ /home/tzakian/TestExample/sources/MyModule.move:47:10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 44 │      fun test_has_coin_bad(a: signer) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │          ----------------- In this function in 0x1::MyModule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    ·</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 47 │          assert!(has_coin(@0x2), 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │          ^^^^^^^^^^^^^^^^^^^^^^^^^^ Test was not expected to abort but it aborted with 1 here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ────── Storage state at point of failure ──────</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 0x1:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       =&gt; key 0x1::MyModule::MyCoin {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│           value: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└──────────────────</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test result: FAILED. Total tests: 4; passed: 3; failed: 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/starcoinorg/starcoin-cookbook/edit/main/docs/03-move/97-move-test/01-move-unit-test.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/move/move-test/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Move test</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/move/move-test/move-integration-test"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Write Move integration test</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#testing-annotations-their-meaning-and-usage" class="table-of-contents__link toc-highlight">Testing Annotations: Their Meaning and Usage</a></li><li><a href="#running-unit-tests" class="table-of-contents__link toc-highlight">Running Unit Tests</a></li><li><a href="#example" class="table-of-contents__link toc-highlight">Example</a></li><li><a href="#running-tests" class="table-of-contents__link toc-highlight">Running Tests</a></li><li><a href="#using-test-flags" class="table-of-contents__link toc-highlight">Using Test Flags</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Documents</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/starcoin" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discor.gg/starcoin" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://t.me/starcoin_contributor" target="_blank" rel="noopener noreferrer" class="footer__link-item">Developer Telegram group<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/StarcoinSTC" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/starcoinorg/starcoin" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Starcoin, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.b2f11fa7.js"></script>
<script src="/assets/js/main.cc2f6e2d.js"></script>
</body>
</html>