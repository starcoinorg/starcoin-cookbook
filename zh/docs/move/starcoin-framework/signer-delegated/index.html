<!doctype html>
<html lang="zh-CN" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-move/starcoin-framework/signer-delegated">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.22">
<title data-rh="true">合约帐户和签名托管 | Starcoin Cookbook</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://starcoinorg.github.io/zh/docs/move/starcoin-framework/signer-delegated"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="合约帐户和签名托管 | Starcoin Cookbook"><meta data-rh="true" name="description" content="从以太坊的合约账户说起"><meta data-rh="true" property="og:description" content="从以太坊的合约账户说起"><link data-rh="true" rel="icon" href="/zh/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://starcoinorg.github.io/zh/docs/move/starcoin-framework/signer-delegated"><link data-rh="true" rel="alternate" href="https://starcoinorg.github.io/docs/move/starcoin-framework/signer-delegated" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://starcoinorg.github.io/zh/docs/move/starcoin-framework/signer-delegated" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://starcoinorg.github.io/docs/move/starcoin-framework/signer-delegated" hreflang="x-default"><link rel="stylesheet" href="/zh/assets/css/styles.bd80adfe.css">
<link rel="preload" href="/zh/assets/js/runtime~main.dce544f6.js" as="script">
<link rel="preload" href="/zh/assets/js/main.4328e06e.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh/"><div class="navbar__logo"><img src="/zh/img/logo.svg" alt="Starcoin Cookbook" class="themedImage_ToTc themedImage--light_HNdA"><img src="/zh/img/logo.svg" alt="Starcoin Cookbook" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Starcoin Cookbook</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh/docs/intro">Documents</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>中文</a><ul class="dropdown__menu"><li><a href="/docs/move/starcoin-framework/signer-delegated" target="_self" rel="noopener noreferrer" class="dropdown__link">English</a></li><li><a href="/zh/docs/move/starcoin-framework/signer-delegated" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">中文</a></li></ul></div><a href="https://github.com/starcoinorg/starcoin-cookbook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh/docs/intro">Starcoin CookBook 介绍</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh/docs/getting-started/install/">新手入门</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/zh/docs/move/">Move 和智能合约开发</a><button aria-label="打开/收起侧边栏菜单「Move 和智能合约开发」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/move/prepare-move-env">设置 Move 开发环境</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/move/quick-start">快速开始</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/docs/move/move-language/">Move 语言</a><button aria-label="打开/收起侧边栏菜单「Move 语言」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/move/understanding-ability">认识 Ability</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/move/move-package-manager">Move 包管理器用户指南</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/zh/docs/move/starcoin-framework/">Starcoin Move Framework</a><button aria-label="打开/收起侧边栏菜单「Starcoin Move Framework」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/move/starcoin-framework/account">Account</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh/docs/move/starcoin-framework/signer-delegated">合约帐户和签名托管</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/move/starcoin-framework/config">Config</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/move/starcoin-framework/token">Token standard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/move/starcoin-framework/nft">NFT 标准</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/move/starcoin-framework/dao">DAO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/move/starcoin-framework/oracle">预言机协议</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/move/deploy-first-move-contract">如何部署 Move 智能合约</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/move/interacting-with-the-contract">与合约交互</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/move/module-dependency">Understanding module dependency</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/move/how-to-upgrade">How to upgrade Move Module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/move/for-solidity-developer">For solidity developer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/move/call-function">如何调用函数</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/docs/move/move-vm/">Move VM 原理分析</a><button aria-label="打开/收起侧边栏菜单「Move VM 原理分析」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/docs/move/move-test/">如何测试 Move Module</a><button aria-label="打开/收起侧边栏菜单「如何测试 Move Module」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/docs/move/move-examples/">更多 Move 例子</a><button aria-label="打开/收起侧边栏菜单「更多 Move 例子」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/docs/move/advance-move/">Move 高级开发</a><button aria-label="打开/收起侧边栏菜单「Move 高级开发」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/docs/move/move-prover/">Move 规范语言和 Move Prover</a><button aria-label="打开/收起侧边栏菜单「Move 规范语言和 Move Prover」" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/web3/">Web3 和 DApp 开发</a><button aria-label="打开/收起侧边栏菜单「Web3 和 DApp 开发」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/reference/">参考</a><button aria-label="打开/收起侧边栏菜单「参考」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/concepts/">概念</a><button aria-label="打开/收起侧边栏菜单「概念」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh/docs/miscellaneous/contributing">杂项</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/zh/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/zh/docs/move/"><span itemprop="name">Move 和智能合约开发</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/zh/docs/move/starcoin-framework/"><span itemprop="name">Starcoin Move Framework</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">合约帐户和签名托管</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>合约帐户和签名托管</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="从以太坊的合约账户说起">从以太坊的合约账户说起<a class="hash-link" href="#从以太坊的合约账户说起" title="标题的直接链接">​</a></h2><p>对比比特币，以太坊最大的创新是引入智能合约，智能合约让区块链拥有了强大的表达能力。
而智能合约的背后，是全新的账户模型。跟比特币的 UTXO 模型不同，以太坊采用了 Account 模型。
以太坊有两种类型的 Account，分别是外部账户（Externally Owned Account）和合约账户（Contract Account）。
这两种账户之间主要有三个方面的差异：</p><p><img loading="lazy" alt="eth_eoc_vs_contract" src="/zh/assets/images/eth_eoc_vs_contract-b9a74815505a440787d59e624b4ebcfa.jpg" width="1354" height="574" class="img_ev3q"></p><ul><li>创建方式</li><li>是否有合约代码</li><li>能否主动发起交易</li></ul><p>外部账户需要通过私钥创建，是面向普通用户的账户，只能存储当前用户的 Balance，不允许有代码。用户通过私钥控制账户，主动发起交易，是普通用户的入口。
而合约账户由外部账户的 Address 等数据计算而来，可以存储代码。账户状态由合约控制，存储通过合约产生的所有数据。</p><p><img loading="lazy" alt="eth_create_account" src="/zh/assets/images/eth_create_account-10ae995fa81df48129844b49ab8fcaa1.jpg" width="1194" height="620" class="img_ev3q"></p><p>这两种账户本质上是希望将用户状态与合约状态分开存储。但是随着区块链的高速发展，以太坊的账户模型面临很多的问题：</p><ol><li>合约产生的状态越来越多、越来越大；</li><li>所有用户的合约数据都存储在相同的合约账户下：<ul><li>容易产生安全隐患（例如大数组问题）；</li><li>数据没有明确的所有权；</li></ul></li><li>没法按状态付费；</li><li>ETH 是一等公民，存储在用户 Balance 下；ERC20 是二等公民，存储在合约账户下；</li><li>合约调用的 Context 理解起来比较复杂，容易引起安全问题；</li><li>代码和状态没有分开存储；</li></ol><p>以太坊在 Account 模型上做了很多创新，但是随着区块链的快速发展，很多设计上的缺陷也越来越明显。
由于 Account 模型对智能合约的支持非常友好，Starcoin 也采用了 Account 模型。
跟以太坊的 Account 模型对比，Starcoin 的 Account 模型有非常大的优势，在继承 Account 模型优势的基础上，很好的弥补了以太坊 Account 模型的不足。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="更先进的-account-模型">更先进的 Account 模型<a class="hash-link" href="#更先进的-account-模型" title="标题的直接链接">​</a></h2><p>为了更好地为广大用户提供服务，Starcoin 的 Account 模型设计了 Data 区和 Code 区。
Data 区用于存储用户数据，Code 区用于存储合约代码，彻底将“用户数据”与“合约代码”分开存储。</p><p><img loading="lazy" alt="starcoin_account" src="/zh/assets/images/starcoin_account-94044f374c9f810f2dbbc1eceb30f5b4.jpg" width="876" height="404" class="img_ev3q"></p><p>由于 Starcoin 的智能合约语言 Move 是面向资源编程的，合约生成的 Resource 在 Move 虚拟机的保障下，只能在账户之间转移，不能被修改（修改必须调用合约）。
所以，在 Starcoin 的账户模型上运行 Move 合约有非常多的优势：</p><ul><li>账户区分 Data 区和 Code 区，合约存储在账户 Code 区</li><li>任何账户都可以同时包含 Data 和 Code</li><li>数据分散存储在用户自己的 Data 区，而不是集中存储到合约账户下</li><li>明确 Resource 的所有权，提升了安全性</li><li>所有 Token（包括 STC）都通过相同的 Token 协议注册，遵循相同的规范</li><li>为状态计费提供可能，避免了“状态爆炸”</li><li>将状态与代码拆分，让合约调用有清晰的上下文</li></ul><p><img loading="lazy" alt="starcoin_account" src="/zh/assets/images/starcoin_account2-8328135a5741333b1b7ffce8bc405892.jpg" width="834" height="441" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="starcoin的合约账户">Starcoin的合约账户<a class="hash-link" href="#starcoin的合约账户" title="标题的直接链接">​</a></h2><p>前面对比了 Starcoin 和以太坊的账户模型，可以说，Starcoin 有更先进的账户模型。
任何一个 Starcoin 账户可以同时存储 Data 和 Code，能覆盖以太坊的所有场景。
为了扩展更丰富的应用场景，Starcoin 也设计了合约账户，所以，Starcoin 跟以太坊一样也包含外部账户（Externally Owned Account）和合约账户（Contract Account）。
但是，Starcoin 的合约账户跟以太坊的合约账户有非常大的区别。接下来我们从以下3个方面，深入介绍 Starcoin 的合约账户。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-starcoin合约账户">1. Starcoin合约账户<a class="hash-link" href="#1-starcoin合约账户" title="标题的直接链接">​</a></h3><p>因为设计目标不一样，Starcoin 的合约账户跟以太坊的合约账户有非常大的区别。Starcoin 的合约账户有以下特点：</p><ul><li>Starcoin 的合约账户本质上是把签名权托管了，除了没有签名权，其他的方面跟 Starcoin 的外部账户完全一致</li><li>Starcoin 的账户实现是统一的，合约账户和外部账户之间可以相互转换</li><li>Starcoin 的合约账户没有签名权，跟以太坊的合约账户一样不能主动发起交易</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-starcoin如何实现合约账户">2. Starcoin如何实现合约账户<a class="hash-link" href="#2-starcoin如何实现合约账户" title="标题的直接链接">​</a></h3><p> Starcoin 的账户代码在 Stdlib 的 <code>Account.move</code> 合约中，实现了外部账户（Externally Owned Account）和合约账户（Contract Account）。
而跟合约账户相关的 Move 代码非常的简洁和巧妙，充分利用了 Move 的优势和特点。以下是 Starcoin 合约账户的主要实现：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// SignerDelegated can only be stored under address, not in other structs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">struct SignerDelegated has key {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// SignerCapability can only be stored in other structs, not under address.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// So that the capability is always controlled by contracts, not by some EOA.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">struct SignerCapability has store { addr: address }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public fun is_signer_delegated(addr: address): bool {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    exists&lt;SignerDelegated&gt;(addr)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">native fun create_signer(addr: address): signer;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>上面的代码中，包含两个 Struct：</p><ul><li>SignerDelegated：存储在合约账户下的一个标记性质的资源，不能拷贝、不能丢弃、不能修改、不能转移，一个账户下如果有 SignerDelegated 表示合约账户，否则是外部账户</li><li>SignerCapability（Capability 是 Move 合约中常用的编程思想，通常表示权限）：表示合约账户 addr 的签名权，谁掌握了 addr 的 SignerCapability，谁就能控制 addr 账户。SignerCapability 也是不能拷贝、不能丢弃、不能修改，只能转发的资源</li></ul><p><img loading="lazy" alt="starcoin_contract_account" src="/zh/assets/images/starcoin_contract_account-541b99e394ac848c2b1906d8ca75b9d1.jpg" width="610" height="292" class="img_ev3q"></p><p>SignerDelegated 像是一把锁，SignerCapability 像是一把钥匙。代码中还包括两个函数：</p><ul><li>is_signer_delegated：在校验交易的时候调用 <code>is_signer_delegated</code> 函数进行判断，禁止合约账户主动发起交易（因为合约账户没有签名权，不能主动发起交易）</li><li>create_signer：create_signer 是 native 的，拥有 addr 的 SignerCapability 的账户可以调用 create_signer 函数，通过代码切换到 addr 合约账户，以 addr 合约账户的身份运行任何合约代码。</li></ul><p>以上是 Starcoin 合约账户的主要实现。Starcoin 将 addr 合约账户的签名权 SignerCapability 进行托管，实现在合约代码中「切换账户」的能力。这么做有什么好处呢？我们在后面讨论合约账户的应用场景的时候再讨论。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-创建-starcoin-合约账户">3. 创建 Starcoin 合约账户<a class="hash-link" href="#3-创建-starcoin-合约账户" title="标题的直接链接">​</a></h3><p>前面我们说过，Starcoin 的账户实现是统一的，合约账户和外部账户之间可以相互转换。
跟以太坊的合约账户创建流程不同，Starcoin 的合约账户创建流程只是在外部账户创建流程的基础上，多了一步“托管签名权”。
下图是 Starcoin 创建账户的流程，最后紫色→和紫色+表示通过外部账户创建合约账户。</p><p><img loading="lazy" alt="create_starcoin_account" src="/zh/assets/images/create_starcoin_account-0a4f753ee8d3150636c66d0395c98280.jpg" width="705" height="472" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="合约账户应用场景">合约账户应用场景<a class="hash-link" href="#合约账户应用场景" title="标题的直接链接">​</a></h2><p>Starcoin 将 addr 合约账户的签名权 SignerCapability 进行托管，实现在合约代码中「切换账户」的能力。这么做有什么好处呢？</p><ul><li><p>掌握签名权 SignerCapability 的任何合约，可以将身份切换成 addr 合约账户的身份，往 addr 合约账户的 Data 区写数据</p></li><li><p>掌握签名权 SignerCapability 的任何合约，可以将身份切换成 addr 合约账户的身份，调用需要 Signer 参数的任何合约函数</p></li></ul><p>以上是 Starcoin 合约账户拥有的重要能力。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-使用合约账户的例子">1. 使用合约账户的例子<a class="hash-link" href="#1-使用合约账户的例子" title="标题的直接链接">​</a></h3><p>我们来想象一下这样的场景。假设某个平台有普通用户和VIP用户，并且针对不同类型的用户读写不同的 Pool 数据。
在合约设计的阶段，考虑到 Common Pool 和 VIP Pool 的安全，不提供直接发起交易的能力，而将两个 Pool 合约的签名权 SignerCapability 托管给 Category Contract。
在用户调用合约的时候，先确定用户类型，再根据类型使用对应的签名权切换身份，调用对应的合约。
这样既能轻松统一用户的入口，保障业务逻辑的正确，又能更好地提供合约的安全性。</p><p><img loading="lazy" alt="starcoin_pool_contract" src="/zh/assets/images/starcoin_pool_contract-a6382291ebc7f9246c176fbc043cf83a.jpg" width="756" height="664" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-starcoin-的第一个合约账户-genesis-account">2. Starcoin 的第一个合约账户 Genesis Account<a class="hash-link" href="#2-starcoin-的第一个合约账户-genesis-account" title="标题的直接链接">​</a></h3><p>在 Starcoin 的 Stdlib 中也能找到很多合约账户应用的例子，最典型的就是 GenesisSignerCapability。
Genesis Account 是 Starcoin 的第一合约账户，没有私钥，不受任何人管理，是一个极其特殊的账户。
同时，Genesis Account 又担负着存储一些全局数据的重任，是 NFT 和 Oracle 的注册中心，是如何做到的呢？
我们来看一下 GenesisSignerCapability 合约的核心代码：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    struct GenesisSignerCapability has key {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        cap: Account::SignerCapability,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public(friend) fun get_genesis_signer(): signer acquires GenesisSignerCapability {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let cap = borrow_global&lt;GenesisSignerCapability&gt;(CoreAddresses::GENESIS_ADDRESS());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Account::create_signer_with_cap(&amp;cap.cap)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>从上面的代码中我们能看到：</p><ul><li>GenesisAccount 没有私钥，不受任何人管理，签名权 SignerCapability 被托管到合约中</li><li>GenesisSignerCapability 保管了 GenesisAccount 的签名权 SignerCapability，并且当成全局数据又存储在了 GenesisAccount 的账户下</li><li>get_genesis_signer 函数是 friend 友元可见性，通过函数授权访问的方式，让 NFT 和 Oracle 合约能够“借用”到 GenesisAccount 的签名权 SignerCapability，从而实现注册中心的功能，让任何人都可以注册 NFT 和 Oracle</li></ul><p>在保障 GenesisAccount 安全的前提下，通过托管签名权 SignerCapability 到合约中，并且在 Stdlib 的 NFT 和 Oracle 得到了很好的应用，存储了非常重要的全局数据。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="总结">总结<a class="hash-link" href="#总结" title="标题的直接链接">​</a></h2><p>相比以太坊的账户模型，Starcoin 的账户模型有非常多的优点，能够覆盖以太坊的所有场景，同时，又能解决很多以太坊面临的问题。
可以说，Starcoin 有更先进的账户模型。</p><p>Starcoin 在统一的账户模型上，巧妙地实现了外部账户和合约账户。
外部账户是普通用户的入口。合约账户则让合约轻松拥有「切换身份」的能力，为合约扩展了更多有意思的场景。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/starcoinorg/starcoin-cookbook/edit/main/i18n/zh/docusaurus-plugin-content-docs/current/03-move/06-starcoin-framework/2-signer-delegated.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/zh/docs/move/starcoin-framework/account"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Account</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/zh/docs/move/starcoin-framework/config"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Config</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#从以太坊的合约账户说起" class="table-of-contents__link toc-highlight">从以太坊的合约账户说起</a></li><li><a href="#更先进的-account-模型" class="table-of-contents__link toc-highlight">更先进的 Account 模型</a></li><li><a href="#starcoin的合约账户" class="table-of-contents__link toc-highlight">Starcoin的合约账户</a><ul><li><a href="#1-starcoin合约账户" class="table-of-contents__link toc-highlight">1. Starcoin合约账户</a></li><li><a href="#2-starcoin如何实现合约账户" class="table-of-contents__link toc-highlight">2. Starcoin如何实现合约账户</a></li><li><a href="#3-创建-starcoin-合约账户" class="table-of-contents__link toc-highlight">3. 创建 Starcoin 合约账户</a></li></ul></li><li><a href="#合约账户应用场景" class="table-of-contents__link toc-highlight">合约账户应用场景</a><ul><li><a href="#1-使用合约账户的例子" class="table-of-contents__link toc-highlight">1. 使用合约账户的例子</a></li><li><a href="#2-starcoin-的第一个合约账户-genesis-account" class="table-of-contents__link toc-highlight">2. Starcoin 的第一个合约账户 Genesis Account</a></li></ul></li><li><a href="#总结" class="table-of-contents__link toc-highlight">总结</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/zh/docs/intro">Documents</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/starcoin" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discor.gg/starcoin" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://t.me/starcoin_contributor" target="_blank" rel="noopener noreferrer" class="footer__link-item">Developer Telegram group<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/StarcoinSTC" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/starcoinorg/starcoin" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Starcoin, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/zh/assets/js/runtime~main.dce544f6.js"></script>
<script src="/zh/assets/js/main.4328e06e.js"></script>
</body>
</html>